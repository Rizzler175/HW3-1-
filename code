const int buttonPin = 2;      
const int redPin = 9;         
const int greenPin = 10;      
const int bluePin = 11;


int mode = 1;  
bool buttonPressed = false;
unsigned long buttonPressTime = 0;
const unsigned long longPressTime = 500; 
bool longPressActive = false;


unsigned long prevMillis = 0;
unsigned long interval = 2000;  
bool ledState = false;          

void setup() {
  pinMode(buttonPin, INPUT_PULLUP);
  pinMode(redPin, OUTPUT);
  pinMode(greenPin, OUTPUT);
  pinMode(bluePin, OUTPUT);
  allOff();
}

void loop() {
  int buttonState = digitalRead(buttonPin);
  unsigned long currentMillis = millis();


  if (buttonState == LOW && !buttonPressed) {
    buttonPressed = true;
    buttonPressTime = currentMillis;
  }


  if (buttonState == HIGH && buttonPressed) {
    unsigned long pressDuration = currentMillis - buttonPressTime;
    buttonPressed = false;

    if (pressDuration < longPressTime && !longPressActive) {

      mode++;
      if (mode > 3) mode = 1;
    }

    longPressActive = false; 
  }


  if (buttonPressed && (currentMillis - buttonPressTime >= longPressTime)) {
    longPressActive = true;
  }


  if (longPressActive) {
 
    allOff();
  } 
  else {
  
    switch (mode) {
      case 1:  
        if (currentMillis - prevMillis >= 2000) {
          prevMillis = currentMillis;
          ledState = !ledState;
        }
        showMode1();
        break;

      case 2:  
        if (currentMillis - prevMillis >= 500) {
          prevMillis = currentMillis;
          ledState = !ledState;
        }
        if (ledState)
          showColor(LOW, LOW, HIGH);  
        else
          allOff();
        break;

      case 3:  
        if (currentMillis - prevMillis >= 500) {
          prevMillis = currentMillis;
          ledState = !ledState;
        }
        if (ledState)
          showColor(LOW, HIGH, HIGH); 
        else
          allOff();
        break;
    }
  }
}

void showMode1() {
  static int colorIndex = 0;                    n
  static unsigned long lastChange = 0;
  unsigned long now = millis();

  if (now - lastChange >= 2000) {
    lastChange = now;
    colorIndex = (colorIndex + 1) % 3; 
  }

  switch (colorIndex) {
    case 0: showColor(HIGH, LOW, HIGH); break;        
    case 1: showColor(LOW, LOW, HIGH); break;        
    case 2: showColor(LOW, HIGH, HIGH); break;        
  }
}

void showColor(int r, int g, int b) {
  digitalWrite(redPin, r);
  digitalWrite(greenPin, g);
  digitalWrite(bluePin, b);
}

void allOff() {
  digitalWrite(redPin, HIGH);
  digitalWrite(greenPin, HIGH);
  digitalWrite(bluePin, HIGH);
}

